(this["webpackJsonptfjs-react-text-detection-ctpn"]=this["webpackJsonptfjs-react-text-detection-ctpn"]||[]).push([[0],{263:function(e,t,a){},264:function(e,t,a){},270:function(e,t){},271:function(e,t){},279:function(e,t){},289:function(e,t){},290:function(e,t){},291:function(e,t){},299:function(e,t){},301:function(e,t,a){"use strict";a.r(t);var r=a(91),s=a.n(r),n=a(235),i=a.n(n),c=(a(263),a(264),a(4)),h=a.n(c),o=a(5),u=a(11),p=a(6),l=a(9),f=a(14),d=a(15),v=a(17),y=a(18);function b(e){return v.E(v.H.flatten(e.arraySync()))}function g(e){var t=e.arraySync(),a=Array.from(t),r=t.sort((function(e,t){return e-t})).map((function(e){return a.indexOf(e)}));return v.F(r)}function _(e){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","TF"==t.method?j(t.dets,t.scores,t.thresh):x(t.dets,t.scores,t.thresh));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,a){return v.m.nonMaxSuppression(e,b(t),2e3,.2,a)}function x(e,t,a){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(h.a.mark((function e(t,a,r){var s,n,i,c,o,u,p,l,f,d,y,_,m,j,x,S,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.slice([0,0],[t.shape[0],1]).squeeze(),n=t.slice([0,1],[t.shape[0],1]).squeeze(),i=t.slice([0,2],[t.shape[0],1]).squeeze(),c=t.slice([0,3],[t.shape[0],1]).squeeze(),o=v.w(i.sub(s).add(1),c.sub(n).add(1)),u=b(u=g(a).reverse()),p=v.F([]);case 8:if(!(u.shape[0]>0)){e.next=26;break}return l=u.slice(0,1).cast("int32"),p=p.concat(l.cast("float32")),f=v.q(s.gather(l),s.gather(u.slice(1,-1).cast("int32"))),d=v.q(n.gather(l),n.gather(u.slice(1,-1).cast("int32"))),y=v.v(i.gather(l),i.gather(u.slice(1,-1).cast("int32"))),_=v.v(c.gather(l),c.gather(u.slice(1,-1).cast("int32"))),m=v.q(0,y.sub(f).add(1)),j=v.q(0,_.sub(d).add(1)),x=m.mul(j),S=v.f(x,o.gather(l).add(o.gather(u.slice(1,-1).cast("int32"))).sub(x)),e.next=21,v.I(S.lessEqual(r));case 21:O=b(O=e.sent),u=u.gather(O.add(1).cast("int32")),e.next=8;break;case 26:return e.abrupt("return",p);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t,a){var r=.5*(e[0]+e[2]),s=.5*(e[1]+e[3]),n=Array.from(e);return n[0]=~~(r-a/2),n[2]=~~(r+a/2),n[1]=~~(s-t/2),n[3]=~~(s+t/2),n}function w(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,r=[0,0,a-1,a-1],s=v.e([e.length,4],"int32"),n=0,i=Object(y.a)(e);try{for(i.s();!(t=i.n()).done;){var c=t.value,h=O(r,c[0],c[1]),u=Object(o.a)(h,4),p=u[0],l=u[1],f=u[2],d=u[3];s.set(p,n,0),s.set(l,n,1),s.set(f,n,2),s.set(d,n,3),n+=1}}catch(b){i.e(b)}finally{i.f()}return s.toTensor()}function k(){arguments.length>2&&void 0!==arguments[2]||(Math.pow(3,2),Math.pow(4,2),Math.pow(5,2),Math.pow(6,2));var e=v.F([11,16,23,33,48,68,97,139,198,283]),t=v.F([16]),a=v.C([e,t.tile(e.shape)],1);return w(a.arraySync())}function M(e,t){var a=(e=e.cast(t.dtype)).slice([0,2],[e.shape[0],1]).reshape([e.shape[0]]),r=e.slice([0,0],[e.shape[0],1]).reshape([e.shape[0]]),s=e.slice([0,3],[e.shape[0],1]).reshape([e.shape[0]]),n=e.slice([0,1],[e.shape[0],1]).reshape([e.shape[0]]),i=v.c(v.D(a,r),1),c=v.c(v.D(s,n),1),h=r.add(v.w(.5,i)),o=n.add(v.w(.5,c)),u=t.slice([0,1],[t.shape[0],1]),p=t.slice([0,3],[t.shape[0],1]),l=h.reshape([h.shape[0],1]),f=v.c(v.w(u,c.reshape([c.shape[0],1])),o.reshape([o.shape[0],1])),d=i.reshape([i.shape[0],1]),y=v.w(v.h(p),c.reshape([c.shape[0],1])),b=l.sub(v.w(.5,d)),g=f.sub(v.w(.5,y)),_=l.add(v.w(.5,d)),m=f.add(v.w(.5,y));return v.C([b,g,_,m],-2).reshape(t.shape)}function N(e,t){var a=v.q(v.v(e.slice([0,0],[e.shape[0],1]),t[1]-1),0),r=v.q(v.v(e.slice([0,1],[e.shape[0],1]),t[0]-1),0),s=v.q(v.v(e.slice([0,2],[e.shape[0],1]),t[1]-1),0),n=v.q(v.v(e.slice([0,3],[e.shape[0],1]),t[0]-1),0);return v.C([a,r,s,n],-2).reshape(e.shape)}function A(e,t,a,r,s){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(h.a.mark((function e(t,a,r,s,n){var i,c,u,p,l,f,d,y,m,j,x,S,O,w,A,T,C,I,F,q,z=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=z.length>5&&void 0!==z[5]?z[5]:[16],c=k(16,[.5,1,2],t.ANCHOR_SCALES),u=c.shape[0],1!==a.shape[0]&&console.error("Only single item batches are supported"),p=[a.shape[1],a.shape[2]],l=p[0],f=p[1],d=v.y(a,[1,l,f,u,2]),y=v.A(d,[0,0,0,0,1],[1,l,f,u,1]).reshape([1,l,f,u]),m=r.clone(),j=v.x(0,f).mul(i),x=v.x(0,l).mul(i),S=v.t(j,x),O=Object(o.a)(S,2),j=O[0],x=O[1],w=v.G(v.C([b(j),b(x),b(j),b(x)],0)),A=u,T=w.shape[0],C=(C=c.reshape([1,A,4]).add(w.reshape([1,T,4]).transpose([1,0,2]))).reshape([T*A,4]),m=m.reshape([-1,4]),y=y.reshape([-1,1]),C=C.cast("int32"),I=N(I=M(C,m),s.arraySync()[0].slice(0,2)),e.next=26,E(I,1*t.min_size);case 26:return F=b(F=e.sent),I=v.i(I,F.cast("int32")),y=v.i(y,F.cast("int32")),m=v.i(m,F.cast("int32")),q=g(b(y)).reverse(),t.pre_nms_topN>0&&(q=v.A(q,0,t.pre_nms_topN)),I=v.i(I,q.cast("int32")),y=v.i(y,q.cast("int32")),m=v.i(m,q.cast("int32")),e.next=38,_({dets:I,scores:y,thresh:t.nms_thresh,method:t.NMS_FUNCTION});case 38:return F=e.sent,console.table(v.s()),t.post_nms_topN>0&&F.shape[0]>t.post_nms_topN&&(F=F.slice(0,t.post_nms_topN)),I=v.i(I,F.cast("int32")),y=v.i(y,F.cast("int32")),m=v.i(m,F.cast("int32")),e.abrupt("return",[b(y.cast("float32")),I.cast("float32"),m]);case 45:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){var a=v.A(e,[0,2],[e.shape[0],1]).reshape([e.shape[0]]),r=v.A(e,[0,0],[e.shape[0],1]).reshape([e.shape[0]]),s=a.sub(r).add(1),n=v.A(e,[0,3],[e.shape[0],1]).reshape([e.shape[0]]),i=v.A(e,[0,1],[e.shape[0],1]).reshape([e.shape[0]]),c=n.sub(i).add(1),h=v.l(s,t),o=v.l(c,t),u=v.o(h,o);return v.I(u)}function C(e,t,a){var r=t/Math.min(e.shape[0],e.shape[1]);null!=a&&r*Math.max(e.shape[0],e.shape[1])>a&&(r=a/Math.max(e.shape[0],e.shape[1]));var s=~~(e.shape[0]*r),n=~~(e.shape[1]*r);return[v.m.resizeBilinear(e,[s,n]),r]}var I=16,F=2,q=.5,z=.9,D=50,P=.7,B=.2,R=.7,L=.7,U=function(){function e(t){Object(p.a)(this,e),this.graph=void 0,this.graph=t}return Object(l.a)(e,[{key:"sub_graphs_connected",value:function(){var e=Object(u.a)(h.a.mark((function e(){var t,a,r,s,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],a=0;case 2:if(!(a<this.graph.shape[0])){e.next=20;break}if(r=this.graph.slice([0,a],[this.graph.shape[0],1]).reshape([this.graph.shape[0]]).any().logicalNot(),s=this.graph.slice([a,0],[1,this.graph.shape[0]]).reshape([this.graph.shape[0]]).any(),!v.o(r,s).arraySync()){e.next=17;break}n=a,t.push([n]);case 9:if(!v.i(this.graph,n).any().arraySync()){e.next=17;break}return e.next=12,v.I(v.i(this.graph,n));case 12:n=(n=e.sent).arraySync()[0][0],t[t.length-1].push(n),e.next=9;break;case 17:a++,e.next=2;break;case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function H(e){return[].reduce.call(e,(function(e,t,a,r){return t>r[e]?a:e}),0)}var X=function(){function e(){Object(p.a)(this,e),this.text_proposals=void 0,this.boxes_table=void 0,this.im_size=void 0,this.heights=void 0,this.scores=void 0,this.text_proposals=[[]],this.im_size=[],this.heights=[],this.scores=v.E([])}return Object(l.a)(e,[{key:"get_successions",value:function(e){for(var t=this.text_proposals[e],a=[],r=Math.round(t[0])+1;r<Math.min(Math.round(t[0])+D+1,this.im_size[1]);r++){var s,n=this.boxes_table[r],i=Object(y.a)(n);try{for(i.s();!(s=i.n()).done;){var c=s.value;this.meet_v_iou(c,e)&&a.push(c)}}catch(h){i.e(h)}finally{i.f()}if(0!==a.length)return a}return a}},{key:"get_precursors",value:function(e){for(var t=this.text_proposals[e],a=[],r=Math.round(t[0])-1;r>Math.max(Math.round(t[0]-D),0)-1;r--){var s,n=this.boxes_table[r],i=Object(y.a)(n);try{for(i.s();!(s=i.n()).done;){var c=s.value;this.meet_v_iou(c,e)&&a.push(c)}}catch(h){i.e(h)}finally{i.f()}if(0!==a.length)return a}return a}},{key:"meet_v_iou",value:function(e,t){var a=this;return function(e,t){var r=a.heights[e],s=a.heights[t],n=Math.max(a.text_proposals[t][1],a.text_proposals[e][1]),i=Math.min(a.text_proposals[t][3],a.text_proposals[e][3]);return Math.max(0,i-n+1)/Math.min(r,s)}(e,t)>=R&&function(e,t){var r=a.heights[e],s=a.heights[t];return Math.min(r,s)/Math.max(r,s)}(e,t)>=L}},{key:"is_succession_node",value:function(e,t){var a=this.get_precursors(t);return v.l(this.scores.gather(e),v.p(this.scores.gather(a))).arraySync()}},{key:"build_graph",value:function(e,t,a){this.text_proposals=e.arraySync(),this.scores=b(t),this.im_size=a;var r=e.slice([0,3],[e.shape[0],1]).reshape([e.shape[0]]),s=e.slice([0,1],[e.shape[0],1]).reshape([e.shape[0]]);this.heights=v.c(v.D(r,s),1).arraySync();var n=Array.from(Array(a[1]),(function(){return[]}));this.text_proposals.forEach((function(e,t){n[Math.round(e[0])].push(t)})),this.boxes_table=n;for(var i=v.e([e.shape[0],e.shape[0]],"bool"),c=0;c<this.text_proposals.length;c++){var h=this.get_successions(c);if(0!==h.length){var o=void 0;o=h.length>1?h[H(this.scores.gather(h).arraySync())]:h[0],this.is_succession_node(c,o)&&i.set(!0,c,o)}}var u=i.toTensor();return new U(u)}}]),e}(),W=a(137),J=a.n(W),Z=function(){function e(t){Object(p.a)(this,e),this.argA=void 0,this.argB=void 0,this.argA=v.j(t,[0]),this.argB=v.j(t,[1])}return Object(l.a)(e,[{key:"solve",value:function(e){return this.argA.mul(e).add(this.argB)}},{key:"equation",get:function(){return"".concat(this.argA.arraySync()," x + ").concat(this.argB.arraySync(),";")}}]),e}();function G(e,t,a){var r=e.arraySync(),s=t.arraySync();r.length<=a&&console.warn("Warning: Polyfit may be poorly conditioned.");for(var n=[],i=s,c=0;c<r.length;c++){for(var h=[],o=0;o<=a;o++)h.push(Math.pow(r[c],o));n.push(h)}var u=J.a.transpose(n),p=J.a.dot(u,n),l=J.a.dot(u,i),f=J.a.inv(p);return v.E(J.a.dot(f,l)).reverse()}var K=function(){function e(){Object(p.a)(this,e),this.graph_builder=void 0,this.graph_builder=new X}return Object(l.a)(e,[{key:"group_text_proposals",value:function(){var e=Object(u.a)(h.a.mark((function e(t,a,r){var s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.graph_builder.build_graph(t,a,r),e.next=3,s.sub_graphs_connected();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"fit_y",value:function(e,t,a,r){if(e.gather(0).equal(e.sum().div(e.shape[0])).arraySync())return[v.j(t,[0]),v.j(t,[0])];var s=new Z(G(e,t,1));return[s.solve(a.arraySync()),s.solve(r.arraySync())]}},{key:"get_text_lines",value:function(){var e=Object(u.a)(h.a.mark((function e(t,a,r){var s,n,i,c,u,p,l,f,d,y,b,g,_,m,j,x,S,O,w,k,M,N,A,T=this;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.group_text_proposals(t,a,r);case 2:for(s=e.sent,n=v.e([s.length,8]),s.forEach((function(e,r){var s=v.i(t,e),i=G(v.c(s.slice([0,0],[s.shape[0],1]).reshape([s.shape[0]]),s.slice([0,2],[s.shape[0],1]).reshape([s.shape[0]])).div(2),v.c(s.slice([0,1],[s.shape[0],1]).reshape([s.shape[0]]),s.slice([0,3],[s.shape[0],1]).reshape([s.shape[0]])).div(2),1),c=v.u(s.slice([0,0],[s.shape[0],1]).reshape([s.shape[0]])),h=v.p(s.slice([0,2],[s.shape[0],1]).reshape([s.shape[0]])),u=v.D(v.j(s,[0,2]),v.j(s,[0,0])).mul(.5),p=T.fit_y(s.slice([0,0],[s.shape[0],1]).reshape([s.shape[0]]),s.slice([0,1],[s.shape[0],1]).reshape([s.shape[0]]),c.add(u),h.sub(u)),l=Object(o.a)(p,2),f=l[0],d=l[1],y=T.fit_y(s.slice([0,0],[s.shape[0],1]).reshape([s.shape[0]]),s.slice([0,3],[s.shape[0],1]).reshape([s.shape[0]]),c.add(u),h.sub(u)),b=Object(o.a)(y,2),g=b[0],_=b[1],m=a.gather(e).sum().div(e.length);n.set(c.arraySync(),r,0),n.set(v.v(f,d).arraySync(),r,1),n.set(h.arraySync(),r,2),n.set(v.q(g,_).arraySync(),r,3),n.set(m.arraySync(),r,4),n.set(i.gather([0]).arraySync(),r,5),n.set(i.gather([1]).arraySync(),r,6);var j=v.r(s.slice([0,3],[s.shape[0],1]).reshape([s.shape[0]]).sub(s.slice([0,1],[s.shape[0],1]).reshape([s.shape[0]])));n.set(j.add(2.5).arraySync(),r,7)})),i=n.toTensor(),c=v.e([n.shape[0],9]),u=0,p=0;p<n.shape[0];p++)l=v.D(v.j(i,[p,6]),v.f(v.j(i,[p,7]),2)),f=v.c(v.j(i,[p,6]),v.f(v.j(i,[p,7]),2)),d=v.j(i,[p,0]),y=v.j(i,[p,5]).mul(v.j(i,[p,0])).add(l),b=v.j(i,[p,2]),g=v.j(i,[p,5]).mul(v.j(i,[p,2])).add(l),_=v.j(i,[p,0]),m=v.j(i,[p,5]).mul(v.j(i,[p,0])).add(f),j=v.j(i,[p,2]),x=v.j(i,[p,5]).mul(v.j(i,[p,2])).add(f),S=b.sub(d),O=g.sub(y),w=v.B(v.c(S.mul(S),O.mul(O))),k=m.sub(y),M=k.mul(O).div(w),N=v.b(M.mul(S).div(w)),A=v.b(M.mul(O).div(w)),v.j(i,[p,5]).less(0).arraySync()?(d=d.sub(N),y=y.add(A),j=j.add(N),x=x.sub(A)):(b=b.add(N),g=g.add(A),_=_.sub(N),m=m.sub(A)),c.set(d.arraySync(),u,0),c.set(y.arraySync(),u,1),c.set(b.arraySync(),u,2),c.set(g.arraySync(),u,3),c.set(_.arraySync(),u,4),c.set(m.arraySync(),u,5),c.set(j.arraySync(),u,6),c.set(x.arraySync(),u,7),c.set(v.j(i,[p,4]).arraySync(),u,8),u+=1;return e.abrupt("return",c.toTensor());case 10:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()}]),e}(),Q=function(){function e(t){Object(p.a)(this,e),this.mode=void 0,this.NMS_FUNCTION=void 0,this.text_proposal_connector=void 0,this.mode=t.DETECT_MODE,this.NMS_FUNCTION=t.NMS_FUNCTION,this.text_proposal_connector=new K}return Object(l.a)(e,[{key:"detect",value:function(){var e=Object(u.a)(h.a.mark((function e(t,a,r){var s,n,i,c,o,u,p,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=b(a),e.next=3,v.I(s.greater(P));case 3:return n=b(n=e.sent).cast("int32"),i=[v.i(t,n),v.i(a,n)],t=i[0],c=g(b(a=i[1])).reverse().cast("int32"),o=[v.i(t,c),v.i(a,c)],t=o[0],a=o[1],e.next=14,_({dets:t,scores:a,thresh:B,method:this.NMS_FUNCTION});case 14:return n=(n=e.sent).cast("int32"),u=[v.i(t,n),v.i(a,n)],t=u[0],a=u[1],e.next=21,this.text_proposal_connector.get_text_lines(t,a,r);case 21:return p=e.sent,e.next=24,this.filter_boxes(p);case 24:return n=e.sent,l=n.unstack(1)[0],e.abrupt("return",p.gather(l));case 27:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"filter_boxes",value:function(){var e=Object(u.a)(h.a.mark((function e(t){var a,r,s,n,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=v.e([t.shape[0],1]),r=v.e([t.shape[0],1]),s=v.e([t.shape[0],1]),n=0,i=0;i<t.shape[0];i++)a.set(v.b(v.j(t,[i,5]).sub(v.j(t,[i,1]))).add(v.b(v.j(t,[i,7]).sub(v.j(t,[i,3])))).div(2).add(1).arraySync(),0,n),r.set(v.b(v.j(t,[i,2]).sub(v.j(t,[i,0]))).add(v.b(v.j(t,[i,6]).sub(v.j(t,[i,4])))).div(2).add(1).arraySync(),0,n),s.set(v.j(t,[i,8]).arraySync(),0,n),n+=1;return a=a.toTensor(),r=r.toTensor(),s=s.toTensor(),e.abrupt("return",v.I(v.o(v.k(r.div(a),q),s.greater(z)).logicalAnd(r.greater(v.w(I,F)))));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function V(e){return v.z(e,-1)}function Y(e,t,a){var r={data:null,rois:null,im_info:null},s=function(e,t){var a,r=e.cast("float32"),s=(r=r.sub(t.PIXEL_MEANS)).shape.slice(0,2),n=Object(o.a)(s,2),i=n[0],c=n[1],h=Math.min(i,c),u=Math.max(i,c),p=[],l=[],f=Object(y.a)(t.SCALES);try{for(f.s();!(a=f.n()).done;){var d=a.value/h;Math.round(d*u)>t.MAX_SIZE&&(d=t.MAX_SIZE/u),console.log("==========>",r,[~~(i*d),~~(c*d)]),e=v.m.resizeBilinear(r,[~~(i*d),~~(c*d)]),l.push(d),p.push(e)}}catch(b){f.e(b)}finally{f.f()}return[$(p),l]}(e,a),n=Object(o.a)(s,2),i=n[0],c=n[1];return r.data=i,[r,c]}function $(e){for(var t=H(e.map((function(e){return e.shape[0]*e.shape[1]*e.shape[2]}))),a=e[t].shape,r=e.length,s=v.J([r,a[0],a[1],3],"float32").arraySync(),n=0;n<r;n++){var i=e[n];s[n]=i.arraySync()}return v.E(s)}var ee=function(){function e(t){Object(p.a)(this,e),this.model=void 0,this.cfg=void 0,this.model=v.n("https://cdn.jsdelivr.net/gh/BadMachine/tfjs-text-detection-ctpn/ctpn_web/model.json"),this.cfg=t}return Object(l.a)(e,[{key:"predict",value:function(){var e=Object(u.a)(h.a.mark((function e(t){var a,r,s,n,i,c,u,p,l,f,d,y,b,g,_,m,j,x,S,O,w,k,M;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v.g().startScope(),a=V(v.d.fromPixels(t,3).cast("float32")),r=C(a,600,1200),s=Object(o.a)(r,2),n=s[0],i=s[1],c=Y(n,0,this.cfg),u=Object(o.a)(c,2),p=u[0],l=u[1],this.cfg.HAS_RPN&&(f=p.data,p.im_info=v.E([[f.shape[1],f.shape[2],l[0]]])),e.next=7,this.model;case 7:return d=e.sent,e.next=10,d.executeAsync(n.expandDims());case 10:return y=e.sent,b=y,g=Object(o.a)(b,2),_=g[0],m=g[1],e.next=14,A(this.cfg,_,m,p.im_info,"TEST");case 14:return j=e.sent,x=Object(o.a)(j,3),S=x[0],O=x[1],x[2],w=v.f(O,l[0]),k=new Q(this.cfg),e.next=23,k.detect(w,S.reshape([S.shape[0],1]),n.shape.slice(0,2));case 23:return(M=e.sent).print(),e.abrupt("return",[M,i]);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"draw",value:function(){var e=Object(u.a)(h.a.mark((function e(t,a,r,s){var n,i,c,o,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.arraySync(),i=Object(y.a)(n);try{for(i.s();!(c=i.n()).done;)o=c.value,(u=t.getContext("2d")).beginPath(),u.strokeStyle=s,u.lineWidth=4,u.moveTo(o[0]/r,o[1]/r),u.lineTo(o[2]/r,o[3]/r),u.lineTo(o[0]/r,o[1]/r),u.lineTo(o[4]/r,o[5]/r),u.lineTo(o[6]/r,o[7]/r),u.lineTo(o[2]/r,o[3]/r),u.stroke(),u.closePath()}catch(h){i.e(h)}finally{i.f()}case 3:case"end":return e.stop()}}),e)})));return function(t,a,r,s){return e.apply(this,arguments)}}()}]),e}(),te=a(62);v.a.set("WEBGL_PACK",!1);var ae=function(e){Object(f.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(p.a)(this,a),(r=t.call(this,e))._canvasRef=s.a.createRef(),r._canvas=void 0,r._cfg=void 0,r._model=void 0,r._cfg={NMS_FUNCTION:"TF",ANCHOR_SCALES:[16],PIXEL_MEANS:v.E([[[102.9801,115.9465,122.7717]]]),SCALES:[600],MAX_SIZE:1e3,HAS_RPN:!0,DETECT_MODE:"O",pre_nms_topN:12e3,post_nms_topN:2e3,nms_thresh:.7,min_size:8},r._model=new ee(r._cfg),r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this._canvas=this._canvasRef.current}},{key:"onUpload",value:function(e){var t=this,a=new FileReader,r=e.target.files[0];if(r.type.match("image.*")){a.readAsDataURL(r);var s=this._canvas;a.onload=function(e){var a=s.getContext("2d"),r=new Image;r.src=e.target.result,r.onload=Object(u.a)(h.a.mark((function e(){var n,i,c,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.complete){e.next=12;break}return s.width=r.width,s.height=r.height,e.next=5,t._model.predict(r);case 5:return n=e.sent,i=Object(o.a)(n,2),c=i[0],u=i[1],a.drawImage(r,0,0),e.next=12,t._model.draw(s,c,u,"red");case 12:case"end":return e.stop()}}),e)})))}}else console.error("not an image")}},{key:"render",value:function(){var e=this;return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)("h1",{children:" Text detection CTPN-React demo "}),Object(te.jsx)("div",{className:"viewPort",style:{minHeight:"300px",minWidth:"400px"},children:Object(te.jsx)("canvas",{ref:this._canvasRef})}),Object(te.jsx)("input",{type:"file",onChange:function(t){return e.onUpload.apply(e,[t])}})]})}}]),a}(s.a.Component);var re=function(){return Object(te.jsx)("div",{className:"App",children:Object(te.jsx)(ae,{children:" "})})},se=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,302)).then((function(t){var a=t.getCLS,r=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;a(e),r(e),s(e),n(e),i(e)}))};i.a.render(Object(te.jsx)(s.a.StrictMode,{children:Object(te.jsx)(re,{})}),document.getElementById("root")),se()}},[[301,1,2]]]);
//# sourceMappingURL=main.738208d4.chunk.js.map